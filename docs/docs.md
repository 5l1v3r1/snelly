<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [Scene description](#scene-description)
-   [Scene](#scene)
    -   [init](#init)
    -   [initGenerator](#initgenerator)
    -   [envMap](#envmap)
    -   [getName](#getname)
    -   [getURL](#geturl)
    -   [shader](#shader)
    -   [initGui](#initgui)
    -   [syncShader](#syncshader)
    -   [getMinScale](#getminscale)
    -   [getMaxScale](#getmaxscale)
    -   [preframeCallback](#preframecallback)
    -   [postframeCallback](#postframecallback)
-   [Materials](#materials)
    -   [loadDielectric](#loaddielectric)
    -   [loadMetal](#loadmetal)
    -   [getDielectric](#getdielectric)
    -   [getMetal](#getmetal)
    -   [getSurface](#getsurface)
-   [Snelly](#snelly)
    -   [getVersion](#getversion)
    -   [getRenderer](#getrenderer)
    -   [getGUI](#getgui)
    -   [getCamera](#getcamera)
    -   [getControls](#getcontrols)
    -   [showGUI](#showgui)
    -   [getMaterials](#getmaterials)
    -   [getSurface](#getsurface-1)
-   [Rendering](#rendering)
-   [Renderer](#renderer)
-   [Utilities](#utilities)
-   [uniformI](#uniformi)
-   [uniformF](#uniformf)
-   [uniform2F](#uniform2f)
-   [uniform1Fv](#uniform1fv)
-   [uniform2Fv](#uniform2fv)
-   [uniform3F](#uniform3f)
-   [uniform3Fv](#uniform3fv)
-   [uniform4F](#uniform4f)
-   [uniform4Fv](#uniform4fv)
-   [uniformMatrix4fv](#uniformmatrix4fv)
-   [GUI](#gui)
-   [Material](#material)
-   [Surface](#surface)
    -   [setRoughness](#setroughness)
-   [Metal](#metal)
-   [Dielectric](#dielectric)

## Scene description

We define the rendered scene by specifying, via the [Scene#shader](#sceneshader), three GLSL functions:

    - `SDF_SURFACE(vec3 X)`: the SDF of the uber-surface material
    - `SDF_METAL(vec3 X)`: the SDF of the (selected) metal material
    - `SDF_DIELECTRIC(vec3 X)`: the SDF of the (selected) dielectric material

These functions are assumed to be SDFs where the negative region corresponds to the interior of the body.
Thus there are at most only three types of material in the scene.

The details of the properties of the three material types can be selected via the [Materials](#materials) object.
In addition, spatial dependence of the material surface properties can be introduced by providing modulating GLSL functions.


## Scene

### init

Optionally (but usually), provide this function to set scene and renderer initial state.

**Parameters**

-   `snelly` **[Snelly](#snelly)** The snelly object

### initGenerator

Optionally, provide this function which generates the init code to re-generate 
the current UI parameter settings. This will be dumped to the console (along with 
the rest of the UI state) on pressing key 'O', allowing the scene and renderer
state to be tweaked in the UI then saved by copy-pasting code into the init function below.

### envMap

Optionally, supply an env-map texture URL (must be a lat-long format image).
(If this is function not implemented, or it returns the empty string, a uniform
temperature blackbody sky is used).

### getName

Optional name (displayed in UI)

### getURL

Optional clickable URL (displayed in UI)

### shader

Return a chunk of GLSL code defining the SDFs which determine the geometry of uber-surface, metal and dielectric materials in the scene.
Define also (optionally) functions giving the 3d spatial dependence of the material parameters.
This function is mandatory!

The code _must_ define at least one of the three functions:

```glsl
     float SDF_METAL(vec3 X);
     float SDF_DIELECTRIC(vec3 X);
     float SDF_DIFFUSE(vec3 X);
```

(If only one or two of these are present, the others will not be rendered).
Optionally, any of the following functions defining the spatial _modulation_ of material parameters can be defined.
(Any of the user-defined functions below can be omitted, in which case they will be replaced with the default indicated).

```glsl
// space-varying multiplier to the UI-exposed color (defaults to vec3(1.0))
vec3 SURFACE_DIFFUSE_REFLECTANCE(in vec3 X);

// space-varying multiplier to the UI-exposed color (defaults to vec3(1.0))
vec3 SURFACE_SPECULAR_REFLECTANCE(in vec3 X);

// space-varying multiplier to the UI-exposed constant (defaults to 1.0)
float SURFACE_IOR(in vec3 X);

// space-varying multiplier to the UI-exposed constant (defaults to 1.0)
float SURFACE_ROUGHNESS(in vec3 X);

// space-varying multiplier to the UI-exposed color (defaults to vec3(1.0))
vec3 METAL_SPECULAR_REFLECTANCE(in vec3 X);

// space-varying multiplier to the UI-exposed constant (defaults to 1.0)
float METAL_ROUGHNESS(in vec3 X);

// space-varying multiplier to the UI-exposed color (defaults to vec3(1.0))
vec3 DIELECTRIC_SPECULAR_REFLECTANCE(in vec3 X);

// space-varying multiplier to the UI-exposed constant (defaults to 1.0)
float DIELECTRIC_ROUGHNESS(in vec3 X);
```

### initGui

/\* Optional. Set up gui and callbacks for this scene

**Parameters**

-   `gui`  
-   `The` **[GUI](#gui)** GUI object

### syncShader

/_ Optional. Called whenever the UI is changed,
/_ and must sync the params of the shader with the current UI settings

**Parameters**

-   `shader`  
-   `The` **Shader** Shader object

### getMinScale

Optional. Gives the raytracer some indication of the (rough) minimum length scale, 
so it can set tolerances appropriately. This sets the rough length scale of the smallest 
resolvable structure. (Note that decreasing this will usually lead to longer render times).
Defaults to 0.0001.

### getMaxScale

Optional. Gives the raytracer some indication of the (rough) maximum length scale, 
so it can set tolerances appropriately. The raymarcher will march no further
from the camera than this scale, thus it acts as the "far plane" distance.
(Note that increasing this will usually lead to longer render times).
Defaults to 100.0.

### preframeCallback

Optional callback before every frame.
Animation rendering logic can be implemented here by updating the scene 
programmatically according to the global time since init

**Parameters**

-   `snelly`  
-   `gl`  
-   `The` **[Snelly](#snelly)** snelly object
-   `The` **[WebGLRenderingContext](https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext)** webGL context

### postframeCallback

Optional callback after every frame.
Animation rendering logic can be implemented here by updating the scene 
programmatically according to the global time since init

**Parameters**

-   `snelly`  
-   `gl`  
-   `The` **[Snelly](#snelly)** snelly object
-   `The` **[WebGLRenderingContext](https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext)** webGL context

## Materials

### loadDielectric

Load the desired Dielectric object by name. Supported dielectrics are:

-   "Constant IOR dielectric"
-   "Glass (BK7)"
-   "Glass (K7)"
-   "Glass (F5)"
-   "Glass (LAFN7)"
-   "Glass (LASF35)"
-   "Glass (N-LAK33A)"
-   "Glass (N-FK51A)"
-   "Glass (SF4)"
-   "Glass (SF67)"
-   "Water"
-   "Polycarbonate"
-   "Glycerol"
-   "Liquid Crystal (E7)"
-   "Diamond"
-   "Quartz"
-   "Fused Silica"
-   "Sapphire"
-   "Sodium Chloride"
-   "Proustite"
-   "Rutile (Titanium Dioxide)"
-   "Silver Chloride"

**Parameters**

-   `dielectricName` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** one of the names listed above

Returns **[Dielectric](#dielectric)** the loaded dielectric

### loadMetal

Load the desired Metal object by name. Supported metals are:

-   "Aluminium"
-   "Brass",   
-   "Calcium", 
-   "Chromium",
-   "Cobalt",  
-   "Copper",  
-   "Gold",    
-   "Iridium", 
-   "Iron",    
-   "Lead",    
-   "Mercury", 
-   "Molybdenum
-   "Nickel",  
-   "Palladium"
-   "Platinum",
-   "Silicon", 
-   "Silver",  
-   "Titanium",
-   "Tungsten",
-   "Vanadium",
-   "Zinc",    
-   "Zirconium"

**Parameters**

-   `metalName` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** one of the names listed above

Returns **[Metal](#metal)** the loaded metal

### getDielectric

Get the currently loaded Dielectric object.

Returns **[Dielectric](#dielectric)** 

### getMetal

Get the currently loaded Metal object.

Returns **[Metal](#metal)** 

### getSurface

Get the Surface object.

Returns **[Surface](#surface)** 

## Snelly

**Parameters**

-   `sceneObj` **[Scene](#scene)** The user-defined scene

### getVersion

Returns the current version number of the snelly system, in the format [1, 2, 3]

Returns **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)** 

### getRenderer

Access to the Renderer object

Returns **[Renderer](#renderer)** 

### getGUI

Access to the GUI object

Returns **[Renderer](#renderer)** 

### getCamera

Access to the camera object

Returns **THREE.PerspectiveCamera** .

### getControls

Access to the camera controller object

Returns **THREE.OrbitControls** .

### showGUI

Programmatically show or hide the dat.GUI UI

**Parameters**

-   `showGUI`  
-   `snelly` **[Boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** The snelly object

### getMaterials

Get materials object

Returns **[Materials](#materials)** the Materials object.

### getSurface

Get Surface object

Returns **[Surface](#surface)** the Surface object.

## Rendering

The renderer itself is a uni-directional pathtracer (with adjunct modes for ambient occlusion and normals rendering).

## Pathtracing

Relevent parameters are

      renderer.renderMode      (default 'pt')
      renderer.maxBounces      (default 4)
      renderer.maxMarchSteps 
      renderer.radianceClamp   (log scale)
      renderer.skyPower 
      renderer.skyTemperature 
      renderer.exposure 
      renderer.gamma 
      renderer.whitepoint 
      renderer.goalFPS 

### Lighting

For simplicity, the only light in the scene is a (non-HDRI) environment map. This can be specified via a URL to 
to a lat-long map, or otherwise will be taken to be a constant intensity sky. (See the envMap call).
In both cases, the sky spectrum is modulated by a blackbody emission spectrum with adjustable temperature.


## Renderer

## Utilities

We provide some utilities for more easily setting up GUI control of the GLSL-defined scene.


## uniformI

Provide an integer (via uniform1i) to the currently bound shader

**Parameters**

-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The name of the uniform variable
-   `i` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** The integer value

## uniformF

Provide a float (via uniform1f) to the currently bound shader

**Parameters**

-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The name of the uniform variable
-   `f`  
-   `i` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** The float value

## uniform2F

Provide a vec2 uniform (via uniform2f) to the currently bound shader

**Parameters**

-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The name of the uniform variable
-   `f1` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** The first float value
-   `f2` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** The second float value

## uniform1Fv

Provide an array of floats (via uniform1Fv) to the currently bound shader
  i.e. the shader declares e.g. `uniform float values[19];`

**Parameters**

-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The name of the uniform variable
-   `fvec` **[Float32Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float32Array)** An array of floats

## uniform2Fv

Provide an array of vec2 (via uniform2fv) to the currently bound shader
  i.e. the shader declares e.g. `uniform vec2 vectors[19];`

**Parameters**

-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The name of the uniform variable
-   `fvec2` **[Float32Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float32Array)** An array of floats, 2 per vector

## uniform3F

Provide a vec3 uniform (via uniform3f) to the currently bound shader

**Parameters**

-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The name of the uniform variable
-   `f1` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** The first float value
-   `f2` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** The second float value
-   `f3` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** The third float value

## uniform3Fv

Provide an array of vec3 (via uniform3fv) to the currently bound shader
  i.e. the shader declares e.g. `uniform vec3 vectors[19];`

**Parameters**

-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The name of the uniform variable
-   `fvec3` **[Float32Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float32Array)** An array of floats, 3 per vector

## uniform4F

Provide a vec4 uniform (via uniform4F) to the currently bound shader

**Parameters**

-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The name of the uniform variable
-   `f1` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** The first float value
-   `f2` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** The second float value
-   `f3` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** The fourth float value
-   `f4`  

## uniform4Fv

Provide an array of vec4 (via uniform4fv) to the currently bound shader
  i.e. the shader declares e.g. `uniform vec4 vectors[19];`

**Parameters**

-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The name of the uniform variable
-   `fvec4` **[Float32Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float32Array)** An array of floats, 4 per vector

## uniformMatrix4fv

Provide a matrix (via uniformMatrix4fv) to the currently bound shader
/\*  i.e. the shader declares e.g. `uniform mat4 matrix;`

**Parameters**

-   `name` **[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** The name of the uniform variable
-   `matrixArray16` **[Float32Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float32Array)** An array of 16 floats

## GUI

**Parameters**

-   `visible`   (optional, default `true`)

## Material

**Parameters**

-   `name`  
-   `desc`  

## Surface

**Parameters**

-   `name`  
-   `desc`  

**Properties**

-   `roughness` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** The surface roughness
-   `ior` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** The surface coating ior
-   `diffuseAlbedo` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)** The surface diffuse (RGB) color
-   `specAlbedo` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)** The surface spec (RGB) color

**Examples**

```javascript
surface.roughness = 0.05;
surface.ior = 1.3530655391120507;
surface.diffuseAlbedo = [0.5, 0.5, 0.5];
surface.specAlbedo = [0.0, 0.0, 0.0];
```

### setRoughness

Set surface roughness

**Parameters**

-   `roughness`  
-   `the` **[number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)** surface roughness in [0,1].

## Metal

**Parameters**

-   `name`  
-   `desc`  

**Examples**

```javascript
let metal = materials.loadMetal('Gold');
 metal.roughness = 0.05;
```

## Dielectric

**Parameters**

-   `name`  
-   `desc`  

**Examples**

```javascript
let dielectric = materials.loadDielectric('Diamond');
dielectric.absorptionColor = [1.0, 1.0, 1.0];
dielectric.absorptionScale = 1.0; // mfp in multiples of scene scale
dielectric.roughness = 0.030443974630021145;
```
