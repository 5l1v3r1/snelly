

<body onload="onLoad();">

<div class="fluence-render" id="content">
	<canvas id="render-canvas" width="820" height="461"></canvas>
</div>


<script type="text/javascript" src="js/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="js/three/three.min.js"></script>
<script type="text/javascript" src="js/three/controls/OrbitControls.js"></script>
<script type="text/javascript" src="js/require.js"></script>

<script type="text/javascript" src="js/gl.js"></script>
<script type="text/javascript" src="js/renderer.js"></script>

<script type="text/javascript">


var render_canvas;

var frame;

// THREE.js OrbitControls
var controls;

// Renderer object
var renderer;

// shim layer with setTimeout fallback
window.requestAnimFrame = (function(){
  return  window.requestAnimationFrame       ||
          window.webkitRequestAnimationFrame ||
          window.mozRequestAnimationFrame    ||
          function( callback ){
            window.setTimeout(callback, 1000 / 60);
          };
})();



// todo: use bl.ocks.org to serve the webGL app publicly ..
// (or at least, the minified version of it, e.g. use r.js to minify)


function onLoad()
{
	frame = 0;

	render_canvas = document.getElementById('render-canvas');

	render_canvas.width  = window.innerWidth;
	render_canvas.height = window.innerHeight;

	window.addEventListener( 'resize', onWindowResize, false );

	// Instantiate renderer object
	renderer = new Renderer();

	// Create user control system for camera
	controls = new THREE.OrbitControls( renderer.getCamera() );
	controls.addEventListener( 'change', camChanged );

	animateLoop();
}



function camChanged()
{
	renderer.render();
}

function animateLoop() 
{
	//console.log("frame: " + frame);
	requestAnimFrame(animateLoop);

	controls.update();

	renderer.render();

	frame = frame+1;
}


function onWindowResize() 
{
	render_canvas.width  = window.innerWidth;
	render_canvas.height = window.innerHeight;

	renderer.resize(render_canvas.width, render_canvas.height);
	renderer.render();
}


</script>

</body>


